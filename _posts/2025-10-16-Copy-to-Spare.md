---
title: 【PowerEdge】メンバー交換/Copy-to-Spare
date: 2025-10-19 00:00:00 +09:00
tags: [PowerEdge, PERC, RAID, Copy to Spare]     # TAG names should always be lowercase
---

Dell Technologiesの技術文書を見ていると、「ホットスペアメンバー交換(Copy to Spare)」という概念があったので、メモを残します。

## ホットスペアメンバー交換(Copy to Spare)

前提として、ベンダーでは予測されるドライブ障害(Predictive Failure)に対して、Firmwareや各種ソフトウェアの更新を推奨しています。

[PowerEdge：予測されるドライブの故障とその解決方法 - Dell 日本](https://www.dell.com/support/kbdoc/ja-jp/000126418/)

「ホットスペアメンバー交換(Copy to Spare)」というのは、予兆障害が確認されたディスクを交換する際に使用されるもので、障害ディスクからホットスペアのディスクに対してデータをコピーして、予兆障害のディスクを交換し、その後データをコピーしたホットスペアのディスクから交換後のディスクに対してデータを再コピーするものです。

Copy to Spareを行うためには、いくつかの条件があります。技術文書に記載がありますが、下記に列挙してみます。筆者の解釈も追加しています。
- PERC6*以降のRAIDコントローラを搭載したPowerEdge、PowerVault製品である。\
※PERC6i、PERC6Eはファームウェアv6.1.1-0047以降が搭載されていること。
- RAID5、RAID6、RAID50、RAID60で構成されたVirtual Diskが存在する。\
※障害(Fail)ディスクが発生した時点で、Virtual DiskがDegradedの状態になるため、「健全なVirtual Disk」と読み替えても良いかもしれません。
- 障害待機ディスク(ホットスペア指定のディスク)が存在する。
- OpenManage Server Administrator(以下OMSA)がインストールされている、またはiDRAC racadmコマンドが使用できる環境下である。\
※Copy to Spareは予兆障害の時点で交換を実施するため、手動で操作できる環境を準備する必要があります。

[PowerEdge: PERC上のVirtual Diskにおけるホットスペアメンバー交換(Copy to Spare)手順 - Dell 日本](https://www.dell.com/support/kbdoc/ja-jp/000139631/)

つまり、予兆障害の時点で、手動でホットスペアのディスクにデータを移して、障害ディスクを交換して、戻すことを、「Copy to Spare」と呼んでいるようです。

## メンバー交換

### PERC9
PERC9のマニュアルを見ると、障害ディスクが発生してホットスペアでRebuildされた状態から、障害ディスクを交換して戻すことをメンバー交換と呼んでいるように見受けられます。原文は後述しますが、Failになったディスクが検知された際に、ホットスペアのディスクが自動的にRebuild開始して、仮想ディスクを最適な状態に戻してくれて、Failのディスクが交換されたら、新しいディスクに対して、ホットスペアのディスクからデータを戻しますよ、と書かれています。

[Dell EMC PowerEdge RAID Controller 9ユーザーズ ガイド H330、H730、およびH830](https://dl.dell.com/content/manual53993545-dell-emc-poweredge-raid-controller-9%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%BA-%E3%82%AC%E3%82%A4%E3%83%89-h330-h730-%E3%81%8A%E3%82%88%E3%81%B3h830.pdf?language=ja-jp)

<details><summary>【原文】P31 メンバーの交換機能と回復可能ホットスペアの使用</summary>

メンバー交換機能では、あらかじめ認定されているホット スペアを使用可能なホット スペアに戻すことができます。  
仮想ディスク内でディスク障害が発生すると、割り当てられているホット スペア（専用またはグローバル）が認定され、仮想ディスクが最適な状態になるまで再構築を開始します。障害ディスクが（同じスロットで）交換された、ホット スペアへの再構築が完了した後、コントローラーは認定ホット スペアのデータを新たに挿入されたディスクへコピーする処理を自動的に開始します。  
データのコピーが終わると、新しいディスクが仮想ディスクの一部になり、ホットスペアは再びホットスペアとして機能できる準備完了の状態に戻ります。これにより、常に特定のエンクロージャスロットがホットスペアとして維持されるようになります。  
コントローラがホットスペアを元に戻している間、仮想ディスクは最適な状態で維持されます。  
コントローラがホットスペアを自動的に元の状態に戻すのは、同じスロットで不良ディスクを新しいドライブに交換した場合に限られます。  
新しいディスクが同じスロットに配置されていない場合は、手動のメンバー交換操作を使用して、以前に認定されたホット スペアを元に戻すことができます。  

メモ: メンバー交換操作は、通常、ディスクのパフォーマンスに一時的な影響を与えます。操作が完了すると、パフォーマンスは通常状態に戻ります。

</details>

### PERC13
PERC13のマニュアルを見ると、同様の機能を、「コピーバックとリプレース」とも呼称するよ、という記述もありました。

>メモ: メンバーの交換は、一部の管理アプリケーションまたはイベントにおいては「コピーバックとリプレース」とも呼ばれます。

[Dell PERC13 および PERC12 ユーザーズ ガイド PERC H975シリーズおよびPERC H965シリーズ カード](https://dl.dell.com/content/manual41299796-dell-perc13-%E3%81%8A%E3%82%88%E3%81%B3-perc12-%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%BA-%E3%82%AC%E3%82%A4%E3%83%89-perc-h975%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA%E3%81%8A%E3%82%88%E3%81%B3perc-h965%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-%E3%82%AB%E3%83%BC%E3%83%89.pdf?language=ja-jp)

特定のディスクが障害ステータス(Fail)になり、ホットスペアのディスクで再構築が完了、ディスク交換をして、ホットスペアのディスクからデータが自動で戻る動作を「メンバー交換」と呼んでいるようです。

## まとめ
- 予兆障害など、仮想ディスクが健全な状態、ホットスペアがまだ生きている状態でディスクを交換したいときに使うのが、「ホットスペアメンバー交換(Copy-to-Spare)」。
- ディスクがFailして、ホットスペア指定のディスクでRebuildが完了したのちに、Failしたディスクを交換して、データを戻すのが「メンバー交換」。

余談ですが、「PERC」は、「PowerEdge RAID Controller」の頭文字をとってそのように呼称されています。かっこいい。\
[PowerEdge：Dell製システムのPowerEdge RAIDコントローラー タイプのリスト | Dell 日本](https://www.dell.com/support/kbdoc/ja-jp/000131648/)
